{"version":3,"sources":["../../app-es6/controllers/FormularioFornecedoresController.js"],"names":["FormularioFornecedoresController","$select","document","querySelector","bind","_mensagem","Bind","Mensagem","MensagemView","_conectaDB","FornecedoresService","_validacoes","Validacoes","cb","$","modal","on","focus","_fornecedor","Fornecedor","FormFornecedorView","cardapios","Cardapios","FormCardapioView","_easyAutocomplete","console","log","url","classe","options","getValue","element","nome","Captalize","string","list","match","enabled","easyAutocomplete","item","Array","prototype","slice","call","querySelectorAll","event","id","preventDefault","init","listaFornecedores","fornecedoresController","_listaDeFornecedores","lista","forEach","index","arr","_id","cardapio","adiciona","setaValores","qtdMax","local","tipo","observacoes","link","Cardapio","exclui","fornecedor","iteraObjeto","propriedade","objeto","target","value","i","funcao","prop","hasOwnProperty","invalido","validaRegExp","_todosInputs","novaMsg","Object","defineProperty","enumerable","propValidas","includes","promise","enviarNovoFornecedor","editaFornecedor","then","end","importa","res","helperCadastraSeNaoTiver","listaTipo","adicionaTipo","listaLocal","adicionaLocal","catch","err","trataErrorsInput","param","connection","tipoObj","toLowerCase","length","Existe","some","promiseAdiciona","erros","JSON","parse","errors","input","classList","add","remove"],"mappings":"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","file":"FormularioFornecedoresController.js","sourcesContent":["class FormularioFornecedoresController{\r\n\tconstructor(){\r\n\t\t\r\n\t\tlet $select = document.querySelector.bind(document);\r\n\r\n\t\tthis._mensagem =  new Bind(\r\n\t\t\tnew Mensagem(),\r\n\t\t\tnew MensagemView($select(\"#mensagemView\")),\r\n\t\t\t'novaMsg');\r\n\r\n\t\tthis._conectaDB = new FornecedoresService();\r\n\r\n\t\tthis._validacoes = new Validacoes();\r\n\t}\r\n\r\n\tinit(cb){\r\n\t\t\r\n\t\tlet $select = document.querySelector.bind(document);\r\n\r\n\t\t$('.modal').modal();\r\n\r\n\t\t$('.modal').on('shown.bs.modal', function () {\r\n\t\t\t$('#nome').focus();\r\n\t\t  });\r\n\r\n\t\tthis._fornecedor = new Bind(\r\n\t\t\tnew Fornecedor(),\r\n\t\t\tnew FormFornecedorView($select(\"#fornecedorView\")),\r\n\t\t\t'id', 'limpa', 'setaValores' );\r\n\r\n\t\tthis._fornecedor.cardapios =  new Bind(\r\n\t\t\tnew Cardapios(),\r\n\t\t\tnew FormCardapioView(document.querySelector(\"#cardapiosView\")),\r\n\t\t\t'adiciona', 'exclui', 'limpa');\r\n\t\t//console.log('init.fornecedor.cardapios.lista', this._fornecedor.cardapios.lista);\r\n\t\tthis._easyAutocomplete(\"/v1/tipofornecedor\", \"#fornecedorView #tipo\");\r\n\t\tthis._easyAutocomplete(\"/v1/localfornecedor\", \"#fornecedorView #local\");\r\n\t\t\r\n\t\tconsole.log($select('#fornecedorView #nome'));\r\n\t\tif(cb){\r\n\t\t\tcb();\r\n\t\t\t\t\t\t\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tend(){\r\n\r\n\t\t$('.modal').modal(\"hide\");\r\n\t\tthis._fornecedor = {};\r\n\t\t//console.log('end.fornecedor.cardapio', this._fornecedor.cardapios);\r\n\t}\r\n\r\n\t_easyAutocomplete(url, classe){\r\n\t\tvar options = {\r\n\t\t\turl: url,\r\n\t\t\tgetValue: function(element) {\r\n\t\t\t\tconsole.log(this, element.nome);\r\n\t\t\t\treturn Captalize.string(element.nome);\r\n\t\t\t},\r\n\t\t\tlist: {\r\n\t\t\t\tmatch: {\r\n\t\t\t\t\tenabled: true\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\t$(classe).easyAutocomplete(options);\r\n\t}\r\n\r\n\t_todosInputs(item){ \r\n\t\treturn Array.prototype.slice.call(document.querySelectorAll(\".formulario_fornecedor input\"));\r\n\t}\r\n\r\n\teditaFornecedor(event, id){\r\n\t\tevent.preventDefault();\r\n\r\n\t\tthis.init(() =>{\r\n\t\t\t\r\n\t\t\tlet listaFornecedores = fornecedoresController._listaDeFornecedores.lista;\r\n\r\n\t\t\tlistaFornecedores.forEach((item, index, arr) =>{\r\n\r\n\t\t\t\tif(item._id == id){\r\n\t\t\t\t\t\r\n\t\t\t\t\titem.cardapios.lista.forEach((cardapio, index) =>{\r\n\t\t\t\t\t\tthis._fornecedor.cardapios.adiciona(cardapio);\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tthis._fornecedor.setaValores(item.id, item.nome, item.qtdMax, item.local, item.tipo, item.observacoes, this._fornecedor.cardapios, item.link);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tthis._easyAutocomplete(\"/v1/tipofornecedor\", \"#fornecedorView #tipo\");\r\n\t\t\tthis._easyAutocomplete(\"/v1/localfornecedor\", \"#fornecedorView #local\");\r\n\t\t});\r\n\t}\r\n\r\n\tadicionaCardapio(event){\r\n\t\tevent.preventDefault();\r\n\t\tlet cardapio = new Cardapio();\r\n\t\tthis._fornecedor.cardapios.adiciona(cardapio);\r\n\t}\r\n\r\n\tremoveCardapio(event, index){\r\n\t\tevent.preventDefault();\r\n\t\tthis._fornecedor.cardapios.exclui(index);\r\n\t}\r\n\r\n\tsetValPropFornecedor(event){\r\n\r\n\t\tlet fornecedor = this._fornecedor;\r\n\t\tthis.iteraObjeto(fornecedor, (propriedade, objeto) =>{\r\n\t\t\tif(propriedade == `${event.target.id}`) \r\n\t\t\t\tobjeto[propriedade] = event.target.value\r\n\t\t});\r\n\r\n\t}\r\n\r\n\tsetValPropCardapio(event, index){\r\n\t\tthis._fornecedor.cardapios.lista.forEach((cardapio, i, arr)=>{\r\n\t\t\tif(i == index){\r\n\t\t\t\tthis.iteraObjeto(cardapio, (propriedade, objeto) =>{\r\n\t\t\t\t\tif(propriedade == `${event.target.id}`) \r\n\t\t\t\t\t\tobjeto[propriedade] = event.target.value;\r\n\t\t\t\t});\t\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n\r\n\titeraObjeto(objeto, funcao){\r\n\t\tvar i = 0;\r\n\t\tfor (var prop in objeto) {\r\n\t\t\tif (objeto.hasOwnProperty(prop)) {\r\n\t\t\t\tfuncao(prop, objeto, i);\r\n\t\t\t\ti++\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tadiciona(event){\r\n\r\n\t\tevent.preventDefault();\r\n\t\t\r\n\t\tlet $select = document.querySelector.bind(document);\r\n\t\tlet invalido = this._validacoes.validaRegExp(this._todosInputs());\r\n\r\n\t\tconsole.log('invalido: ', invalido);\r\n\t\tif(invalido)\r\n\t\t{\r\n\t\t\tthis._mensagem.novaMsg('Por favor preencha os campos obrigatórios', \"danger\", 2400);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t//criando o object para ser enviado\r\n\t\tlet fornecedor = this._fornecedor;\r\n\t\t\t\t\r\n\t\tObject.defineProperty(fornecedor, '_id', {\r\n\t\t\tenumerable: false\r\n\t\t});\r\n\r\n\t\tfornecedor.cardapios.lista.forEach((cardapio, i, arr) =>{\r\n\t\t\t\r\n\t\t\tlet propValidas = [ 'nome', 'valorPorPessoa', 'aluguel', 'dj', 'decoracao'];\r\n\r\n\t\t\tfor(var prop in cardapio){\r\n\t\t\t\tif( !propValidas.includes(prop)) Object.defineProperty(cardapio, prop, {enumerable: false})\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\treturn cardapio;\r\n\t\t});\r\n\r\n\t\tfornecedor.cardapios = fornecedor.cardapios.lista;\r\n\r\n\t\tlet promise;\r\n\r\n\t\tif(!fornecedor.id){\tpromise = this._conectaDB.enviarNovoFornecedor(fornecedor); }\r\n\t\telse{ promise = this._conectaDB.editaFornecedor(fornecedor.id, fornecedor); }\r\n\t\t\r\n\t\tpromise\r\n\t\t.then(res => {\r\n\t\t\tthis._mensagem.novaMsg('Forncedor incluido com sucesso', \"success\", 2400);\r\n\t\t\tthis.end();\r\n\t\t\tfornecedoresController.importa();\r\n\t\t\tconsole.log(res);\r\n\t\t})\r\n\t\t.then(() => {\r\n\t\t\tthis.helperCadastraSeNaoTiver(this._conectaDB.listaTipo(), \r\n\t\t\t\tfornecedor.tipo, \r\n\t\t\t\tthis._conectaDB,\r\n\t\t\t\tthis._conectaDB.adicionaTipo.bind(this._conectaDB));\r\n\t\t})\r\n\t\t.then(() => {\r\n\r\n\t\t\tthis.helperCadastraSeNaoTiver(this._conectaDB.listaLocal(), \r\n\t\t\t\tfornecedor.local, \r\n\t\t\t\tthis._conectaDB,\r\n\t\t\t\tthis._conectaDB.adicionaLocal.bind(this._conectaDB));\r\n\t\t})\r\n\t\t.catch(err => {\r\n\t\t\tconsole.log(err);\r\n\t\t\ttrataErrorsInput(err);\r\n\t\t\tthis._mensagem.novaMsg('Não foi possível cadastrar o fornecedor.', \"danger\", 2400);\r\n\t\t});\r\n\r\n\r\n\t}\r\n\r\n\thelperCadastraSeNaoTiver(promise, param, connection, adiciona){\r\n\r\n\t\tlet tipoObj = {nome: param.toLowerCase()};\r\n\r\n\t\tpromise\r\n\t\t.then(res =>{\r\n\t\t\tif(res.length)\r\n\t\t\t{\r\n\t\t\t\tvar Existe = res.some((item, i, arr) =>{ return item.nome.toLowerCase() == param.toLowerCase(); });\r\n\r\n\t\t\t\tif(!Existe){\r\n\r\n\t\t\t\t\tlet promiseAdiciona = adiciona(tipoObj);\r\n\t\t\t\t\tpromiseAdiciona.then(res => console.log(res)).catch(err => console.log(err));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\t\r\n\t\t\t\tlet promiseAdiciona = adiciona(tipoObj);\r\n\t\t\t\tpromiseAdiciona.then(res => console.log(res)).catch(err => console.log(err));\r\n\t\t\t}\r\n\t\t})\r\n\t\t.catch(err =>{\r\n\t\t\tconsole.log(err);\r\n\t\t});\r\n\t}\r\n\r\n\ttrataErrorsInput(err){\r\n\t\tvar erros = JSON.parse(err).errors;\r\n\r\n\t\tthis.iteraObjeto(erros, (prop, objeto, index) => {\r\n\t\t\tthis._todosInputs().forEach(input => {\r\n\t\t\t\tif(input.id == prop){\r\n\t\t\t\t\tinput.classList.add(\"is-invalid\");\r\n\t\t\t\t\t input.focus()\r\n\t\t\t\t}\r\n\t\t\t\telse{ \r\n\t\t\t\t\tinput.classList.remove(\"is-invalid\");\r\n\t\t\t\t}\r\n\t\t\t})\t\t\t\t\r\n\t\t});\r\n\t}\r\n}"]}