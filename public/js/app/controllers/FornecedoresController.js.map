{"version":3,"sources":["../../app-es6/controllers/FornecedoresController.js"],"names":["FornecedoresController","$select","document","querySelector","bind","_mensagem","Bind","Mensagem","MensagemView","_listaDeFornecedores","Fornecedores","ListaFornecedoresView","_sort","Sort","_convidados","_consultaDB","FornecedoresService","importa","event","preventDefault","filtro","srcElement","value","filtroBusca","filtroTipo","filtroLocal","console","log","filtra","item","i","arr","umaPropBate","validador","tipo","nome","qtdMax","local","property","hasOwnProperty","valor","propBate","toLowerCase","includes","limpa","promisse","obterListaFornecedores","then","res","forEach","adiciona","fornecedor","propagaSelectTipo","listaTipo","listaLocal","catch","err","novaMsg","teste","_listaDeFornecedoresl","lista","cardapios","cardapio","convidados","template","update","coluna","ordena","inputId","consulta","promise","input","option1","createElement","length","remove","text","add","option","id","index","deletaFornecedorPorId","verdadeiro","exclui","_inputNomeProduto","_inputQuantidade","_inputValor","focus"],"mappings":"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","file":"FornecedoresController.js","sourcesContent":["class FornecedoresController{\n\tconstructor(){\n\t\t\n\t\tlet $select = document.querySelector.bind(document);\n\n\t\tthis._mensagem =  new Bind(\n\t\t\tnew Mensagem(),\n\t\t\tnew MensagemView($select(\"#mensagemView\")),\n\t\t\t'novaMsg');\n\n\t\tthis._listaDeFornecedores =  new Bind(\n\t\t\tnew Fornecedores(), \n\t\t\tnew ListaFornecedoresView($select(\"#listaFornecedoresView\")), \n\t\t\t'adiciona', 'exclui', 'ordena', 'ordenaReverse','filtra', 'lista', 'limpa');\n\t\t\n\t\tthis._sort = new Sort();\n\t\tthis._convidados = $select(\"#convidados\");\n\n\t\tthis._consultaDB = new FornecedoresService();\n\t\t\n\n\t\tthis.importa();\n\t}\n\n\tfiltra(event){\n\t\tevent.preventDefault();\n\t\tlet filtro = event.srcElement.value;\n\n\t\tlet filtroBusca = document.querySelector(\"#filtroBusca\").value;\n\t\tlet filtroTipo = document.querySelector(\"#selectTipo\").value;\n\t\tlet filtroLocal = document.querySelector(\"#selectLocal\").value;\n\n\t\tconsole.log(\"filtro: \", filtroBusca);\n\t\tconsole.log(\"tipo: \", filtroTipo);\n\n\t\tthis._listaDeFornecedores.filtra((item, i, arr )=>{\n\t\t\tvar umaPropBate = false;\n\t\t\tvar validador = {\n\t\t\t\ttipo: false,\n\t\t\t\tnome: false,\n\t\t\t\tqtdMax: false,\n\t\t\t\tlocal: false\n\t\t\t\t\n\t\t\t}\n\n\t\t\tfor (var property in item) {\n\t\t\t\tif (item.hasOwnProperty(property)) {\n\n\t\t\t\t\tlet valor = item[property];\n\t\t\t\t\tvar propBate;\n\n\t\t\t\t\tswitch(property){\n\t\t\t\t\t\tcase \"nome\":\n\t\t\t\t\t\t\tvalor = item[property].toLowerCase();\n\t\t\t\t\t\t\tvalidador.nome = valor.includes(filtroBusca.toLowerCase());\n\t\t\t\t\t\t\t//console.log('validador.nome', validador.nome,property ,item[property]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"qtdMax\":\n\t\t\t\t\t\t\tvalor = item[property];\n\t\t\t\t\t\t\tvalidador.qtdMax = valor == filtroBusca;\n\t\t\t\t\t\t\t//console.log('validador.qtdMax', validador.qtdMax,property ,item[property]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"local\":\n\t\t\t\t\t\t\tvalor = item[property].toLowerCase();\n\t\t\t\t\t\t\tvalidador.local = valor.includes(filtroLocal.toLowerCase());\n\t\t\t\t\t\t\t//console.log('validador.local', validador.local,property ,item[property]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"tipo\":\n\t\t\t\t\t\t\tvalor = item[property].toLowerCase();\n\t\t\t\t\t\t\tvalidador.tipo = valor.includes(filtroTipo.toLowerCase());\n\t\t\t\t\t\t\t//console.log('validador.local', validador.local,property ,item[property]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconsole.log(item, validador)\n\n\t\t\tif(validador.tipo && validador.local && (validador.nome || validador.qtdMax)){\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t});\n\t\tthis._sort.limpa('fa-sort');\n\t\t\n\t}\n\n\timporta(){\n\t\t\n\t\tthis._listaDeFornecedores.limpa();\n\n\t\tlet promisse = this._consultaDB.obterListaFornecedores(this._convidados.value);\n\t\tpromisse\n\t\t.then(res => res.forEach(fornecedor => \t{\n\t\t\n\t\t\tthis._listaDeFornecedores.adiciona(fornecedor);\n\t\t}))\n\t\t.then(() =>{\n\t\t\tthis.propagaSelectTipo(\"#filtroTipo select\", this._consultaDB.listaTipo());\n\t\t\tthis.propagaSelectTipo(\"#filtroLocal select\", this._consultaDB.listaLocal());\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log(err);\n\t\t\tthis._mensagem.novaMsg(err, \"danger\", 2400);\n\t\t});\n\n\t\tthis._sort.limpa('fa-sort');\n\n\t}\n\tcontaConvidados(event){\n\t\tthis.teste = this._listaDeFornecedoresl;\n\t\tthis._listaDeFornecedores.lista.forEach(fornecedor => fornecedor.cardapios.lista.forEach(cardapio => cardapio.convidados = event.srcElement.value));\n\t\tlet template = new ListaFornecedoresView(document.querySelector(\"#listaFornecedoresView\"));\n\t\ttemplate.update(this._listaDeFornecedores);\n\n\t\tthis._mensagem.novaMsg(\"Convidados Recalculado!\",\"success\", 2400);\n\t}\n\n\tordena(event, coluna){\n\t\tthis._sort.ordena(event, coluna, this._listaDeFornecedores);\n\t\t//this._mensagem.novaMsg(`Coluna ${coluna} ordenada`,\"info\", 1400);\n\t}\n\n\n\tpropagaSelectTipo(inputId, consulta){\n\t\tlet promise = consulta;\n\t\tlet input = document.querySelector(inputId);\n\t\tlet option1 = document.createElement(\"option\");\n\n\t\twhile (input.length) {\n\t        input.remove(0);\n\t    }\n\t    option1.value = \"\";\n\t    option1.text = \"...\";\n\t    input.add(option1);\n\n\t\tpromise.\n\t\tthen(res =>{\n\t\t\tres.forEach((item, i) =>{\n\t\t\t\tlet option = document.createElement(\"option\");\n\t\t\t\toption.value =  item.nome;\n\t\t\t\toption.text = item.nome;\n\n\t\t\t\tinput.add(option);\n\t\t\t});\n\t\t\t\n\t\t})\n\t\t.catch(err =>console.log(err));\n\t}\n\n\texcluiFornecedor(event, id, index){\n\t\tevent.preventDefault();\n\n\t\tlet promisse = this._consultaDB.deletaFornecedorPorId(id);\n\n\t\tpromisse\n\t\t.then((verdadeiro) => {\n\t\t\tif(verdadeiro){\n\t\t\t\tthis._mensagem.novaMsg(\"Item excluído da lista!\", \"success\", 2400);\n\t\t\t\tthis._listaDeFornecedores.exclui(index);\t\n\t\t\t}\n\t\t})\n\t\t.catch(err => this._mensagem.novaMsg(err, \"danger\", 2400));\n\t\t\n\t}\n\n\n\t_limpaFormulario(){\n\t\tthis._inputNomeProduto.value = '';\n\t\tthis._inputQuantidade.value = 1;\n\t\tthis._inputValor.value = 0.0;\n\t\tthis._inputNomeProduto.focus();\n\t}\n\t\n\n}"]}